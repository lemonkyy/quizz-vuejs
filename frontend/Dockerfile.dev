FROM node:23-alpine3.20 AS base

RUN apk add --no-cache g++ make py3-pip libc6-compat nginx curl

WORKDIR /app

COPY package*.json ./

RUN npm ci 

COPY . .

RUN chmod -R 755 /app

COPY ./build/nginx-dev.conf /etc/nginx/http.d/default.conf

CMD ["sh", "-c", "nginx && npm run dev"]

EXPOSE 80